<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-CL" xml:lang="es-CL"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martín Cumsille">

<title>Proyecto Gestión Financiera</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Hito-1-Martin-Cumsille_files/libs/clipboard/clipboard.min.js"></script>
<script src="Hito-1-Martin-Cumsille_files/libs/quarto-html/quarto.js"></script>
<script src="Hito-1-Martin-Cumsille_files/libs/quarto-html/popper.min.js"></script>
<script src="Hito-1-Martin-Cumsille_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Hito-1-Martin-Cumsille_files/libs/quarto-html/anchor.min.js"></script>
<link href="Hito-1-Martin-Cumsille_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Hito-1-Martin-Cumsille_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Hito-1-Martin-Cumsille_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Hito-1-Martin-Cumsille_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Hito-1-Martin-Cumsille_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Proyecto Gestión Financiera</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Martín Cumsille </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="hito-1" class="level1">
<h1>Hito 1:</h1>
<section id="análisis-de-opción-put-de-acciones-de-mercado-libre" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-opción-put-de-acciones-de-mercado-libre">Análisis de Opción put de acciones de Mercado Libre</h2>
<p>Fecha de entrega límite: Miercoles 25 de Septiembre</p>
<section id="sector-y-temática" class="level3">
<h3 class="anchored" data-anchor-id="sector-y-temática">Sector y Temática</h3>
<p>El derivado de Mercado Libre, está en el sector de tecnología, ya que su negocio se basa en plataformas digitales y comercio electrónico. La empresa es conocida principalmente por su plataforma de e-commerce y su solución de pago digital.</p>
<p>En el sector tecnológico, Mercado Libre es de los principales en latinoamérica, facilitando transacciones. Esta se enfoca en la creación de un entorno en línea donde hay interacción entre consumidores y comerciantes.</p>
<p>La perspectiva de crecimiento que maneja, es alta, ya que se ha beneficiado mucho del comercio electrónico del sector y se espera que siga siendo actor relevante. Además, su inversión en tecnología de última generación y en la expansión de su red logística refuerza su posición en mercados clave como Brasil, Argentina y México.</p>
<p>Aunque el sector es competitivo y sensible a la evolución económica y política en estos países, Mercadolibre está bien posicionada para capitalizar el aumento del comercio electrónico y los pagos digitales en América Latina.</p>
</section>
<section id="motivación" class="level3">
<h3 class="anchored" data-anchor-id="motivación">Motivación</h3>
<p>Elegí está empresa debido al dominio que tiene en el mercado E-commerce y también por cómo ha impulsado los pagos digitales y su logística de envío de productos de varias partes del mundo. Esta empresa, ha sido un impulso para la venta de productos de varias empresas y ha generado un tremendo aporte en estas.</p>
<p>Según estudios académicos, se ha demostrado que la expansión de servicios digitales ha sido un motor significativo de crecimiento en el sector. Esto reduce las barreras comerciales y mejora la inclusión financiera, ya que todos compiten de igual a igual. Aparte el comercio electrónico, está relacionado de gran forma con el crecimiento del PIB. Por todo esto, me causó gran interés analizar este activo tan relevante a día de hoy.</p>
</section>
<section id="contexto" class="level3">
<h3 class="anchored" data-anchor-id="contexto">Contexto</h3>
<p>Respecto al análisis de la opción Mercado Libre tiene tres variables importantes. Por un lado, el precio del activo subyacente que vendría siendo la empresa Mercado Libre, por otra parte la volatilidad implícita y por último, la prima de la opción.</p>
<p>El precio del activo subyacente del activo, actualmente está en 2140 USD, lo que quiere decir que la opción que se está usando está cercana al valor (2130 USD), lo cual es un valor relevante, ya que se especula que podría llegar a 2150 USD. Este valor debería seguir aumentando debido a la expansión de sus servicios y la creciente adopción digital de la región.</p>
<p><a href="https://doi.org/10.1002/bse.2945"><img src="Data/Foto-activo-MELI-1.png" class="img-fluid quarto-figure quarto-figure-center" alt="Figura 1: Opción call Mercado Libre"></a> Fuente:Yahoo Finance Figura 1: Opción call Mercado Libre</p>
<p>La volatilidad implícita, mide las expectativas del mercado sobre las futuras fluctuaciones de las acciones de esta empresa. Siendo esta una empresa líder en comercio electrónico en América Latina, su volatilidad tiende a ser elevada, debido a la naturaleza de sus operaciones y su exposición a riesgos. Según el análisis de Zúñiga y Rodriguez (2020) sobre la volatilidad de mercados emergentes, las fluctuaciones en el entorno político y económico afectan bastante a empresas como Mercado Libre y por ende el valor de las opciones. Por otra parte, la prima de la opción refleja el valor temporal e intrínseco. Esta tiene un valor temporal más limitado, ya que su fecha de vencimiento es en septiembre de 2024. Esto otorga tiempo, para que factores de mercado, impacten en el precio de las acciones. Según Merton(1976) las opciones con fechas de vencimiento más cercanas tienen un valor reducido, sin embargo si Mercado Libre se sigue consolidando la empresa podría ganar más valor.</p>
</section>
<section id="derivado" class="level3">
<h3 class="anchored" data-anchor-id="derivado">Derivado</h3>
<p>Para hacer la proyección del activo se deben definir parámetros:</p>
<ol type="1">
<li><p>**Precio inicial del activo subyacente (S0): 2140,1</p></li>
<li><p><strong>Precio de ejercicio (K):</strong> 2130</p></li>
<li><p><strong>Precio del bono:</strong> 108,94</p></li>
<li><p><strong>Days range:</strong> 12,26</p></li>
<li><p><strong>Precio de la opción (Q3):</strong> 13,4</p></li>
<li><p><strong>Estado downer:</strong> st(wd)=d<em>s0-(days-range)=d</em>( 2,135.51-12,26)=2123,25</p></li>
<li><p><strong>Estado Upper:</strong> st(wu)=u*so+(day-range) = u( 2,135.51+12,26)=2147,77</p></li>
<li><p><strong>Factor de caída (D):</strong> 0,994</p></li>
<li><p><strong>Factor de crecimiento (U):</strong> 1,005</p></li>
<li><p><strong>Rendimiento al vencimiento (r):</strong> 3,91%</p></li>
</ol>
<p><a href="https://doi.org/10.1002/bse.2945"><img src="Data/Segunda-foto.png" class="img-fluid quarto-figure quarto-figure-center" alt="Figura 2"></a> MercadoLibre Fuente:Yahoo Finance</p>
<p><a href="https://doi.org/10.1002/bse.2945"><img src="Data/Tercera-foto.png" class="img-fluid quarto-figure quarto-figure-center" alt="Figura 3"></a> iShares ETF de Bonos del Tesoro a 10-20 Años. Fuente:Yahoo Finance</p>
<p>Para este análisis se ocupa el rendimiento a vencimiento del iShares ETF de Bonos del Tesoro a 10-20 años (TLH), el cual se encuentra alineado con los bonos del tesoro de Estados Unidos. Este actualmente tiene un Yield del 3,91%. Utilizando esta tasa de retorno, se puede hacer una valoración más real de la opción.</p>
<p>Con estos datos se creó la matriz W, obteniendo los siguientes resultados:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://doi.org/10.1002/bse.2945"><img src="Data/Cuarta-foto.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Figura 4"></a></p>
</figure>
</div>
<figcaption>Figura 4</figcaption>
</figure>
</div>
<p>Retornos de la Opción MELI Fuente: Elaboración propia</p>
<p>Acá se aprecia cómo se comportan el activo, la opción y el bono en el escenario Upper y Downer. En la primera columna de la matriz W se ve como el valor del bono es -108,94 con un retorno de 425,9 en ambos escenarios. Esto tiene sentido, ya que es un activo libre de riesgo.</p>
<p>Ya para la segunda columna se observa el precio del activo de -2140,1 con un entorno favorable llega a 2150,8 mientras que con uno desfavorable llega a 2127,25. Evidenciando que los cambios no llegan a ser tan drásticos.</p>
<p>En la tercera columna se puede apreciar la opción de compra con su valor de -13,4. Acá se observa que en su estado upper llega a un valor de 20,8 mientras que en su estado downer pierde su valor.</p>
<p>Se definió la expresión para Q3 obteniendo los siguientes valores:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://doi.org/10.1002/bse.2945"><img src="Data/Quinta-foto.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Figura 5"></a></p>
</figure>
</div>
<figcaption>Figura 5</figcaption>
</figure>
</div>
<p>Retornos Opción MELI Fuente: Elaboración propia</p>
<p>También se realizó un modelo Black-Scholes, el cual estima el precio de la opción, asumiendo una tasa libre de riesgo y una volatilidad constante. Acá se usó una volatilidad estimada del 20% y un tiempo de vencimiento de un año donde se contabiliza por mes, aparte de los datos de R, T, S y K que fueron entregados anteriormente.</p>
<p>Con esto se obtuvo lo siguiente:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://doi.org/10.1002/bse.2945"><img src="Data/Sexta-Foto.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Figura 6"></a></p>
</figure>
</div>
<figcaption>Figura 6</figcaption>
</figure>
</div>
<p>Código Black- Scholes Fuente: Elaboración propia</p>
<p>El resultado del modelo nos entregó una proyección del valor de la opción de la acción de 57,68. Esto muestra cuánto debería pagar el inversionista por la opción de compra del activo al vencimiento, lo cual es claramente mayor al actual. Esto se puede deber al gran futuro que tiene la empresa a día de hoy y como crece constantemente.</p>
</section>
<section id="conclusión" class="level3">
<h3 class="anchored" data-anchor-id="conclusión">Conclusión</h3>
<p>La comparación entre el modelo binomial y el modelo de Black-Scholes muestra una nueva forma para valorar opciones. El binomial segmenta el tiempo en intervalos discretos, lo que nos permite apreciar el aumento y valor del activo subyacente. Acá se ajusta el valor de la opción tomando en cuenta el riesgo, lo que ayuda a realizar una gran proyección para opciones como Mercado Libre.</p>
<p>El Black-Scholes nos entrega un enfoque continuo y es más continuo y simplifica algunos elementos del mercado, por lo que es altamente útil para realizar un análisis y valoración rápida.</p>
<p>Sin embargo, en este caso, para Mercado Libre es más útil el modelo binomial, ya que esta empresa opera en un sector bastante dinámico, muy susceptible a cambios en la innovación y las condiciones del mercado, permitiendo un análisis más detallado.</p>
</section>
<section id="referencias" class="level3">
<h3 class="anchored" data-anchor-id="referencias">Referencias</h3>
<p>Yahoo Finance (2024) Mercado Libre.Inc (MELI) Options Chain. Available at: https://finance.yahoo.com/quote/MELI/options/ (Accessed: September 2024).</p>
<p>Yahoo Finance (2024) iShares 10-20 Year Treasury Bond ETF (TLH) Available at: https://finance.yahoo.com/quote/TLH/ (Accessed: September 2024).</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>